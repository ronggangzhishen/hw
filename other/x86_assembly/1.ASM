DATAS SEGMENT
	BUF DB 700 DUP(0)	;'-',ODH,0AH,最大700B
	NUM Dw 100 DUP(0)
	FILE DB 'input3.txt',0
	FLAG DB 0
	N DB 0
DATAS  ENDS

STACK SEGMENT STACK
	DW 100 DUP(?)
STACK ENDS

CODES  SEGMENT
	ASSUME    CS:CODES,DS:DATAS,SS:STACK
START:
	MOV AX,DATAS
	MOV DS,AX
	
	XOR AL,AL
	MOV N,AL
	MOV AH,3DH	;打开文件
	LEA DX,FILE
	INT 21H
	MOV BX,AX	;bx = open FILE
	MOV CX,700
	MOV AH,3FH	;read bx
	LEA DX,BUF
	INT 21H
	MOV CX,AX	;CX=实际字节数
	MOV AH,3EH	;close bx
	INT 21H
	
	
	LEA SI,BUF
	LEA DI,NUM
	XOR AX,AX
	MOV [DI],AX
READ:
	CMP BYTE PTR [SI],2DH;'-' 
	JE CASE1
	CMP BYTE PTR [SI],0DH;
	JE CASE2
	CMP BYTE PTR [SI],0AH;
	JE READNEXT 
	MOV AX,[DI]
	MOV BX,10
	MUL BX		;乘10
	MOV DL,[SI]
	XOR DH,DH
	SUB DX,30H	;ASCII码转数字 
	ADD AX,DX
	MOV [DI],AX
	JMP READNEXT
CASE1:
	MOV FLAG,1	;负 
	JMP READNEXT
CASE2:
	CMP FLAG,0
	JE ANUM
	MOV DX,[DI]
	NEG DX		;取反 
	MOV [DI],DX
ANUM: 
	MOV FLAG,0
	INC DI
	INC DI		;DI+=2
	XOR AX,AX
	MOV [DI],AX	;set 0
	MOV AL,N
	INC AL
	MOV N,AL;N个数 
READNEXT:
	INC SI
	LOOP READ
	;DI里已有所有数，N为个数  
	
	 
	XOR AX,AX       
	MOV AL,N
	MOV SI,AX
	ADD SI,SI
LOOPI:
	DEC SI
	DEC SI
	MOV DI,SI
LOOPJ:
	MOV AX,NUM[DI]
	DEC DI
	DEC DI
	MOV BX,NUM[DI]
	CMP BX,AX
	JG EXCHANGE
	JMP CMPJ
EXCHANGE:
	MOV NUM[DI],AX
	MOV NUM[DI+0002H],BX
CMPJ:
	CMP DI,0
	JG LOOPJ
CMPI:
	CMP SI,0
	JG LOOPI
	
	
	LEA DI,NUM
	XOR CX,CX
	MOV CL,N
L6:
	MOV BX,[DI]
	CMP BX,0
	JG L7
	NEG BX;负数取反 
	MOV DL,'-'
	MOV AH,2
	INT 21H
L7: 
	MOV AX,BX
	CALL PRINTA
	INC DI
	INC DI
	LOOP L6
	
	MOV AX,4C00H
	INT 21H 
	
	

	
PRINTA:;输出AX中的自然数 
	PUSHF
	PUSH BX
	PUSH CX
	PUSH DX
	MOV BX,0
S5:
	MOV CX,10;每次除10，余数进栈 
	DIV CL
	MOV CL,AH
	MOV CH,0
	PUSH CX
	INC BX;BX计数 
	MOV AH,0
	CMP AX,0
	JA S5
	
	MOV AH,02H
	MOV CX,BX
S6:
	POP BX
	MOV DL,BL
	ADD DL,30H;得到数字对应的ASCII码 
	INT 21H
	LOOP S6

	MOV DL,0DH
	INT 21H
	MOV DL,0AH
	INT 21H
	POP DX
	POP CX
	POP BX
	POPF
	RET
CODES ENDS
END START